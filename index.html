<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬ì¼“ëª¬ ì„±ê²© í…ŒìŠ¤íŠ¸ - ìµœì¢… ìˆ˜ì •íŒ</title>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ê°€ë…ì„±ê³¼ ëˆˆì˜ í¸ì•ˆí•¨ì„ ìœ„í•œ ë¬´ì±„ìƒ‰ & ì—ë©”ë„ë“œ í…Œë§ˆ */
            --bg-neutral: #f8f9fa;
            --bg-dot: #dee2e6;
            --window-bg: #1a202c;
            --border-green: #48bb78;
            --text-white: #f7fafc;
            --accent-yellow: #f6e05e;
        }

        body {
            font-family: 'DungGeunMo', monospace;
            margin: 0; padding: 0;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
            background-color: var(--bg-neutral);
            background-image: radial-gradient(var(--bg-dot) 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2d3748;
        }

        #game-container {
            width: 95%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            position: relative;
        }

        /* ê³µí†µ ìœˆë„ìš° ìŠ¤íƒ€ì¼ */
        .window {
            background: var(--window-bg);
            border: 4px solid var(--border-green);
            border-radius: 10px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), inset 0 0 0 2px #000;
            color: var(--text-white);
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }

        /* ìƒë‹¨ ìƒíƒœ ë°” */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 5px;
        }

        .progress-container {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            width: 100%;
        }

        #progress-fill {
            height: 100%;
            background: var(--border-green);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ì§ˆë¬¸ í…ìŠ¤íŠ¸ */
        #question-box {
            min-height: 100px;
            font-size: 1.15rem;
            line-height: 1.6;
            display: flex;
            align-items: center;
            word-break: keep-all;
        }

        /* ì„ íƒì§€ ë²„íŠ¼ ì˜ì—­ */
        #answer-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .btn {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-white);
            font-family: 'DungGeunMo', monospace;
            font-size: 1.05rem;
            text-align: left;
            padding: 12px 15px 12px 35px;
            cursor: pointer;
            position: relative;
            border-radius: 5px;
            transition: all 0.2s;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--border-green);
        }

        .btn:hover::before {
            content: 'â–¶';
            position: absolute;
            left: 12px;
            color: var(--border-green);
        }

        /* í•˜ë‹¨ ì»¨íŠ¸ë¡¤ëŸ¬ */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            padding: 10px;
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .controls span { font-size: 0.8rem; color: #718096; }

        input[type=range] {
            cursor: pointer;
            accent-color: var(--border-green);
        }

        /* ê²°ê³¼ í™”ë©´ */
        .result-view { text-align: center; }
        #pokemon-img { width: 160px; height: 160px; margin: 15px 0; object-fit: contain; }
        .retry-btn { margin-top: 15px; text-align: center !important; padding-left: 15px !important; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<!-- ìœ íŠœë¸Œ í”Œë ˆì´ì–´ (ìˆ¨ê¹€ ì²˜ë¦¬) -->
<div id="player" style="position: absolute; left: -9999px;"></div>

<div id="game-container">
    <div id="ui-header">
        <div class="status-bar">
            <span id="step-name">ì„±ê²© ì§„ë‹¨</span>
            <span id="step-count">0 / 20</span>
        </div>
        <div class="progress-container">
            <div id="progress-fill"></div>
        </div>
    </div>

    <!-- ëŒ€í™”ì°½ -->
    <div id="question-box" class="window">
        <div id="text-display">íƒí—˜ì„ ì‹œì‘í•˜ê¸° ì „... ë‹¹ì‹ ì˜ ì„±ë³„ì„ ì•Œë ¤ì£¼ì„¸ìš”.</div>
    </div>

    <!-- ì„ íƒì°½ -->
    <div id="answer-box" class="window">
        <!-- JSë¡œ ë²„íŠ¼ ìƒì„± -->
    </div>

    <!-- ì‚¬ìš´ë“œ ì»¨íŠ¸ë¡¤ëŸ¬ -->
    <div class="controls">
        <span>BGM ğŸ”ˆ</span>
        <input type="range" id="volume-slider" min="0" max="100" value="30">
        <span>ğŸ”Š</span>
    </div>
</div>

<script>
    // --- ì§ˆë¬¸ ë°ì´í„° ì„¸íŠ¸ (ì´ 25ê°œ ì¤‘ 20ê°œ ëœë¤ ì¶”ì¶œ) ---
    const ALL_QUESTIONS = [
        { q: "íœ´ì¼ì¸ë° ì•„ë¬´ë„ ë†€ì•„ ì£¼ì§€ ì•ŠëŠ”ë‹¤... ê·¸ëŸ¼ ë‹¹ì‹ ì€?", a: [{t: "ì—¬í–‰ì„ ë– ë‚œë‹¤", s: {Jolly: 4}}, {t: "ë©í•˜ê²Œ ìˆëŠ”ë‹¤", s: {Relaxed: 4}}, {t: "ì§‘ì— ë°•í˜€ìˆëŠ”ë‹¤", s: {Lonely: 4}}] },
        { q: "ë¹„ë°€ì„ ë¬´ì‹¬ì½” ëˆ„ì„¤í•´ë²„ë¦° ì ì´ ìˆëŠ”ê°€?", a: [{t: "ìˆë‹¤", s: {Rash: 4}}, {t: "ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ëª¨ë¥´ëŠ” ê²ƒì€ ëª¨ë¥¸ë‹¤ê³  ì†”ì§í•˜ê²Œ ë§í•˜ë‚˜?", a: [{t: "ë§í•œë‹¤", s: {Docile: 4}}, {t: "ì˜ ë§í•˜ì§€ ëª»í•œë‹¤", s: {Timid: 4}}] },
        { q: "ë§¤ì¼ ìš´ë™í•˜ê¸°! ê³„ì†í•  ìˆ˜ ìˆì„ê¹Œ?", a: [{t: "ë‹¹ì—°í•˜ì§€", s: {Hardy: 4}}, {t: "ì‘ì‹¬ì‚¼ì¼ì´ë‹¤", s: {Quirky: 4}}] },
        { q: "ê¸°ìœ ì¼ì´ ìˆìœ¼ë©´ ë‚˜ë„ ëª¨ë¥´ê²Œ ì¶¤ì´ ë‚˜ì˜¤ë‚˜?", a: [{t: "ì˜ˆ", s: {Jolly: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Quiet: 4}}] },
        { q: "ìì£¼ ë„˜ì–´ì§€ê±°ë‚˜ ë‹¤ì¹˜ëŠ” í¸ì¸ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Rash: 4}}, {t: "ì „í˜€", s: {Calm: 4}}] },
        { q: "TV ì±„ë„ì„ ì•„ì£¼ ìì£¼ ë°”ê¾¸ëŠ” í¸ì¸ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Hasty: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Calm: 4}}] },
        { q: "ë„ì‹œì™€ ì‹œê³¨ ì¤‘ ì–´ëŠ ìª½ì´ ì·¨í–¥ì¸ê°€?", a: [{t: "í™”ë ¤í•œ ë„ì‹œ", s: {Sassy: 4}}, {t: "ì¡°ìš©í•œ ì‹œê³¨", s: {Calm: 4}}] },
        { q: "ì£¼ëª©ë°›ëŠ” ìë¦¬ì— ì„œëŠ” ê²ƒì„ ì¦ê¸°ë‚˜?", a: [{t: "ì¦ê¸´ë‹¤", s: {Sassy: 4}}, {t: "í”¼í•˜ê³  ì‹¶ë‹¤", s: {Lonely: 4}}] },
        { q: "ê³„íšì„ ì„¸ìš°ê³  ê·¸ëŒ€ë¡œ ì‹¤ì²œí•˜ëŠ” í¸ì¸ê°€?", a: [{t: "ì˜ˆ", s: {Hardy: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Quirky: 4}}] },
        { q: "ê±°ì§“ë§ë„ ì„ ì˜ë¼ë©´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ë‚˜?", a: [{t: "ì˜ˆ", s: {Quiet: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Brave: 4}}] },
        { q: "ì§€í•˜ì‹¤ì—ì„œ ìˆ˜ìƒí•œ ì†Œë¦¬ê°€ ë“¤ë¦¬ë©´?", a: [{t: "ê°€ë³¸ë‹¤", s: {Brave: 4}}, {t: "ë„ë§ì¹œë‹¤", s: {Timid: 4}}] },
        { q: "ì•½ì† ì‹œê°„ì— ëŠ¦ëŠ” ê²½ìš°ê°€ ì¦ì€ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Rash: 4}}, {t: "ì ˆëŒ€ ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ì¹œêµ¬ê°€ ë§›ìˆëŠ” ê²ƒì„ í˜¼ì ë‹¤ ë¨¹ì–´ë²„ë ¸ë‹¤!", a: [{t: "í™”ë‚¸ë‹¤", s: {Jolly: 4}}, {t: "ìƒê´€ì—†ë‹¤", s: {Calm: 4}}] },
        { q: "ë‚˜ëŠ” ë‚¨ë“¤ë³´ë‹¤ íŠ¹ë³„í•œ ì²œì¬ë¼ê³  ìƒê°í•œ ì  ìˆë‚˜?", a: [{t: "ìˆë‹¤", s: {Sassy: 4}}, {t: "ì „í˜€", s: {Hardy: 4}}] },
        { q: "ì£¼ìœ„ê°€ ì†Œë€ìŠ¤ëŸ¬ì›Œë„ ì§‘ì¤‘ì„ ì˜ í•˜ë‚˜?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Relaxed: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Lonely: 4}}] },
        { q: "ìœ ë ¹ì„  ì•ˆì— ë¬´ì—‡ì´ ìˆì„ ê²ƒ ê°™ë‚˜?", a: [{t: "ë³´ë¬¼!", s: {Jolly: 4}}, {t: "ë¬´ì„œìš´ ê·€ì‹ ", s: {Timid: 4}}] },
        { q: "ì…”ì¸ ë¥¼ ë’¤ì§‘ì–´ ì…ê³  ë‚˜ì™”ë‹¤ëŠ” ë§ì„ ë“¤ìœ¼ë©´?", a: [{t: "ë‹¹í™©í•œë‹¤", s: {Docile: 4}}, {t: "ì›ƒì–´ë„˜ê¸´ë‹¤", s: {Rash: 4}}] },
        { q: "ì‚¬ë†“ê³  ì“°ì§€ ì•ŠëŠ” ë¬¼ê±´ì´ ë§ì€ê°€?", a: [{t: "ë§ë‹¤", s: {Quirky: 4}}, {t: "ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ê°€ê²Œ ì ì›ì´ ë§ì„ ê±¸ì–´ì˜¤ë©´?", a: [{t: "ëŒ€ë‹µí•œë‹¤", s: {Jolly: 4}}, {t: "ë¶€ë‹´ìŠ¤ëŸ½ë‹¤", s: {Timid: 4}}] },
        { q: "ë‚¨ì—ê²Œ ëª…ë ¹ë°›ëŠ” ê²ƒì„ ì‹«ì–´í•˜ë‚˜?", a: [{t: "ì‹«ë‹¤", s: {Sassy: 4}}, {t: "ìƒê´€ì—†ë‹¤", s: {Docile: 4}}] },
        { q: "ì •ì˜ë¥¼ ìœ„í•´ì„œë¼ë©´ ì‹¸ìš¸ ìš©ê¸°ê°€ ìˆë‚˜?", a: [{t: "ìˆë‹¤", s: {Brave: 4}}, {t: "ëª¨ë¥´ê² ë‹¤", s: {Quiet: 4}}] },
        { q: "ê¿ˆì„ ê¾¸ë©´ ìƒìƒí•˜ê²Œ ê¸°ì–µí•˜ëŠ” í¸ì¸ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Naive: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Relaxed: 4}}] },
        { q: "ë³µê¶Œì„ ì‚¬ë©´ ë‹¹ì²¨ë  ê²ƒ ê°™ì€ ê¸°ë¶„ì´ ë“œë‚˜?", a: [{t: "ë‹¹ì—°í•˜ì§€", s: {Jolly: 4}}, {t: "ì„¤ë§ˆ", s: {Calm: 4}}] },
        { q: "ì²˜ìŒ ë³´ëŠ” ì‚¬ëŒê³¼ë„ ê¸ˆë°© ì¹œí•´ì§€ë‚˜?", a: [{t: "ì˜ˆ", s: {Jolly: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Lonely: 4}}] }
    ];

    // --- ì„±ê²© ë° í¬ì¼“ëª¬ ë§¤í•‘ (í•œê¸€í™” ìˆ˜ì • ì™„ë£Œ) ---
    const KOREAN_TYPE_MAP = {
        Hardy: "ë…¸ë ¥í•˜ëŠ”", Docile: "ì˜¨ìˆœí•œ", Brave: "ìš©ê°í•œ", Jolly: "ëª…ë‘í•œ", Impish: "ì¥ë‚œê¾¸ëŸ¬ê¸°", 
        Naive: "ì²œì§„ë‚œë§Œí•œ", Bold: "ëŒ€ë‹´í•œ", Timid: "ê²ìŸì´", Hasty: "ì„±ê¸‰í•œ", Sassy: "ê±´ë°©ì§„", 
        Quiet: "ëƒ‰ì •í•œ", Relaxed: "ë¬´ì‚¬íƒœí‰", Rash: "ëœë ê±°ë¦¬ëŠ”", Quirky: "ë³€ë•ìŠ¤ëŸ¬ìš´", 
        Lonely: "ì™¸ë¡œì›€íƒ€ëŠ”", Calm: "ì°¨ë¶„í•œ"
    };

    const POKEMON_MAP = {
        male: { Hardy: "ì•„ì°¨ëª¨", Docile: "íŒŒì´ë¦¬", Brave: "í”¼ì¹´ì¸„", Jolly: "ë¦¬ì•„ì½”", Impish: "íŒ½ë„ë¦¬", Naive: "ë¶ˆê½ƒìˆ­ì´", Bold: "ëª¨ë¶€ê¸°", Timid: "ë¸Œì¼€ì¸", Hasty: "ì—ë‚˜ë¹„", Sassy: "ëƒì˜¹", Quiet: "ë‚˜ë¬´ì§€ê¸°", Relaxed: "ë¨¹ê³ ì", Rash: "ë¬¼ì§±ì´", Quirky: "ê¼¬ë¶€ê¸°", Lonely: "ì´ìƒí•´ì”¨", Calm: "ì¹˜ì½”ë¦¬íƒ€" },
        female: { Hardy: "ë‚˜ë¬´ì§€ê¸°", Docile: "ì´ìƒí•´ì”¨", Brave: "íŒŒì´ë¦¬", Jolly: "ë¨¹ê³ ì", Impish: "ë¶ˆê½ƒìˆ­ì´", Naive: "ì—ë‚˜ë¹„", Bold: "ê¼¬ë¶€ê¸°", Timid: "ëª¨ë¶€ê¸°", Hasty: "í”¼ì¹´ì¸„", Sassy: "ë¦¬ì•„ì½”", Quiet: "ì¹˜ì½”ë¦¬íƒ€", Relaxed: "ì‹ìŠ¤í…Œì¼", Rash: "ì•„ì°¨ëª¨", Quirky: "íŒ½ë„ë¦¬", Lonely: "ë¬¼ì§±ì´", Calm: "ë¸Œì¼€ì¸" }
    };

    const ID_MAP = { "ì•„ì°¨ëª¨": 255, "íŒŒì´ë¦¬": 4, "í”¼ì¹´ì¸„": 25, "ë¦¬ì•„ì½”": 158, "íŒ½ë„ë¦¬": 393, "ë¶ˆê½ƒìˆ­ì´": 390, "ëª¨ë¶€ê¸°": 387, "ë¸Œì¼€ì¸": 155, "ì—ë‚˜ë¹„": 300, "ëƒì˜¹": 52, "ë‚˜ë¬´ì§€ê¸°": 252, "ë¨¹ê³ ì": 446, "ë¬¼ì§±ì´": 258, "ê¼¬ë¶€ê¸°": 7, "ì´ìƒí•´ì”¨": 1, "ì¹˜ì½”ë¦¬íƒ€": 152, "ì‹ìŠ¤í…Œì¼": 37 };

    // --- ë¡œì§ ì œì–´ ë³€ìˆ˜ ---
    let userGender = '';
    let currentIdx = 0;
    let scores = {};
    let testPool = [];
    const MAX_QUESTIONS = 20;

    // --- ìœ íŠœë¸Œ ì‚¬ìš´ë“œ ì œì–´ ---
    let player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '0', width: '0', videoId: 'ehI75lWfXhw',
            playerVars: { 'autoplay': 0, 'loop': 1, 'playlist': 'ehI75lWfXhw' },
            events: { 'onReady': onPlayerReady }
        });
    }

    function onPlayerReady(event) {
        const slider = document.getElementById('volume-slider');
        event.target.setVolume(slider.value);
        slider.oninput = (e) => event.target.setVolume(e.target.value);
    }

    // --- ê²Œì„ ì´ˆê¸°í™” ë° ì‹¤í–‰ ---
    function init() {
        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = `
            <button class="btn" onclick="startTest('male')">ë‚¨ì ì•„ì´</button>
            <button class="btn" onclick="startTest('female')">ì—¬ì ì•„ì´</button>
        `;
    }

    function startTest(gender) {
        userGender = gender;
        // ìŠ¤ì½”ì–´ 0ìœ¼ë¡œ ì´ˆê¸°í™”
        Object.keys(KOREAN_TYPE_MAP).forEach(k => scores[k] = 0);
        // ì§ˆë¬¸ 20ê°œ ì¤‘ë³µì—†ì´ ëœë¤ ì¶”ì¶œ
        testPool = [...ALL_QUESTIONS].sort(() => Math.random() - 0.5).slice(0, MAX_QUESTIONS);
        
        // ì‚¬ìš´ë“œ ì¬ìƒ (ìœ ì € ì¸í„°ë™ì…˜ í›„)
        if(player && player.playVideo) player.playVideo();
        
        render();
    }

    function render() {
        if (currentIdx >= testPool.length) {
            showResult();
            return;
        }
        
        const data = testPool[currentIdx];
        document.getElementById("text-display").innerText = data.q;
        document.getElementById("step-count").innerText = `${currentIdx + 1} / ${MAX_QUESTIONS}`;
        document.getElementById("progress-fill").style.width = `${((currentIdx + 1) / MAX_QUESTIONS) * 100}%`;

        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = "";
        data.a.forEach(ans => {
            const btn = document.createElement("button");
            btn.className = "btn";
            btn.innerText = ans.t;
            btn.onclick = () => {
                for (let s in ans.s) scores[s] = (scores[s] || 0) + ans.s[s];
                currentIdx++;
                render();
            };
            ansBox.appendChild(btn);
        });
    }

    function showResult() {
        document.getElementById("answer-box").classList.add("hidden");
        document.getElementById("step-name").innerText = "ì§„ë‹¨ ì™„ë£Œ";
        
        // ë™ì ì¸ ê²½ìš° ëœë¤í•˜ê²Œ í•˜ë‚˜ ì„ íƒ
        const maxScore = Math.max(...Object.values(scores));
        const winners = Object.keys(scores).filter(k => scores[k] === maxScore);
        const topKey = winners[Math.floor(Math.random() * winners.length)];
        
        const typeKR = KOREAN_TYPE_MAP[topKey]; // ì˜ë¬¸ ì„±ê²©ì„ í•œê¸€ë¡œ ë³€í™˜
        const name = POKEMON_MAP[userGender][topKey] || "í”¼ì¹´ì¸„";
        const pokeId = ID_MAP[name] || 25;

        const qBox = document.getElementById("question-box");
        qBox.innerHTML = `
            <div class="result-view">
                <p>ë‹¹ì‹ ì˜ ì˜¤ë¼ ìƒ‰ê¹”ë¡œ ë³´ì•„... <br><strong>[${typeKR}]</strong> ì„±ê²©ì´êµ°ìš”!</p>
                <img id="pokemon-img" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokeId}.png" alt="${name}">
                <p style="font-size:1.4rem; color:var(--border-green);">ë‹¹ì‹ ì€ <strong>${name}</strong>ì…ë‹ˆë‹¤!</p>
                <button class="btn retry-btn" onclick="location.reload()">â–¶ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</button>
            </div>
        `;
    }

    // ìœ íŠœë¸Œ API ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ
    const script = document.createElement('script');
    script.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(script);

    init();
</script>
</body>
</html>
