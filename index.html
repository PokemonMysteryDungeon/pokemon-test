<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í¬ì¼“ëª¬ ë¶ˆê°€ì‚¬ì˜ ë˜ì „ ì„±ê²© í…ŒìŠ¤íŠ¸</title>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ê²Œì„ í™”ë©´ ë°°ìƒ‰ */
            --window-bg: #081820;      /* ì–´ë‘ìš´ ë‚¨ìƒ‰ ë°°ê²½ */
            --border-green: #38f838;   /* í˜•ê´‘ ë…¹ìƒ‰ í…Œë‘ë¦¬ */
            --text-white: #ffffff;      /* í°ìƒ‰ í…ìŠ¤íŠ¸ */
            --cursor-color: #ffffff;    /* ì»¤ì„œ ìƒ‰ìƒ */
            --bg-pink: #f8a8f8;         /* ë°°ê²½ ë¶„í™ìƒ‰ */
            --bg-white: #ffffff;        /* ë°°ê²½ í°ìƒ‰(ë¬¼ê²°) */
        }

        body {
            font-family: 'DungGeunMo', monospace;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* ì´ë¯¸ì§€ì™€ ìœ ì‚¬í•œ ë¶„í™ìƒ‰ ë¬¼ê²° ë°°ê²½ ìƒì„± */
            background: repeating-linear-gradient(
                45deg,
                var(--bg-pink),
                var(--bg-pink) 40px,
                var(--bg-white) 40px,
                var(--bg-white) 80px
            );
            background-size: 200% 200%;
            animation: wave 10s linear infinite;
            overflow: hidden;
        }

        @keyframes wave {
            0% { background-position: 0% 0%; }
            100% { background-position: 100% 100%; }
        }

        /* ì „ì²´ ê²Œì„ í™”ë©´ ì»¨í…Œì´ë„ˆ (DS í™”ë©´ ë¹„ìœ¨ ëŠë‚Œ) */
        #game-screen {
            width: 100%;
            max-width: 600px;
            height: 450px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 20px;
            box-sizing: border-box;
        }

        /* ê³µí†µ ìœˆë„ìš° ìŠ¤íƒ€ì¼ (ì´ë¯¸ì§€ì˜ ê·¸ ëŠë‚Œ) */
        .window {
            background-color: var(--window-bg);
            border: 4px solid var(--border-green);
            border-radius: 8px;
            box-shadow: inset 0 0 0 2px #000; /* ì•ˆìª½ ê²€ì€ ì„  */
            color: var(--text-white);
            image-rendering: pixelated;
        }

        /* ìƒë‹¨ ì„ íƒì§€ ìœˆë„ìš° */
        #answer-container {
            align-self: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            width: 70%;
            margin-bottom: 10px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 2;
        }

        /* í•˜ë‹¨ ë©”ì‹œì§€ ìœˆë„ìš° */
        #question-box {
            width: 100%;
            min-height: 100px;
            padding: 15px 20px;
            box-sizing: border-box;
            font-size: 1.3rem;
            line-height: 1.5;
            z-index: 1;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ì´ë¯¸ì§€ì˜ ì„ íƒì§€ ìŠ¤íƒ€ì¼) */
        .answer-btn {
            background: transparent;
            border: none;
            color: var(--text-white);
            font-family: 'DungGeunMo', monospace;
            font-size: 1.2rem;
            text-align: left;
            padding: 5px 5px 5px 30px;
            cursor: pointer;
            position: relative;
            width: 100%;
        }

        /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ í™”ì‚´í‘œ ì»¤ì„œ ë“±ì¥ */
        .answer-btn:hover::before {
            content: 'â–¶';
            position: absolute;
            left: 5px;
            color: var(--text-white);
        }
        
        /* ì§„í–‰ë°” ìŠ¤íƒ€ì¼ë§ */
        .progress-bar-container {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 10px;
            background: rgba(0,0,0,0.3);
            border: 2px solid var(--border-green);
            border-radius: 5px;
        }
        #progress-fill {
            height: 100%;
            background: var(--border-green);
            width: 0%;
            transition: width 0.3s;
        }

        /* ê²°ê³¼ í™”ë©´ íŠ¹ìˆ˜ ìŠ¤íƒ€ì¼ */
        .result-content {
            text-align: center;
            padding: 20px;
        }
        #pokemon-img {
            width: 120px;
            image-rendering: pixelated;
            margin: 10px 0;
        }

        .hidden { display: none !important; }

        /* í•˜ë‹¨ ë³¼ë¥¨ ì»¨íŠ¸ë¡¤ */
        .volume-box {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 0.8rem;
            color: #000;
        }
    </style>
</head>
<body>

<div id="player" style="position: absolute; left: -9999px;"></div>

<div id="game-screen">
    <div class="progress-bar-container" id="p-bar-wrap">
        <div id="progress-fill"></div>
    </div>

    <!-- ì„ íƒì§€ ì˜ì—­ -->
    <div id="answer-container" class="window">
        <!-- ë™ì ìœ¼ë¡œ ë²„íŠ¼ì´ ìƒì„±ë©ë‹ˆë‹¤ -->
    </div>

    <!-- ëŒ€í™”ì°½ ì˜ì—­ -->
    <div id="question-box" class="window">
        <div id="main-text">íƒí—˜ì„ ë– ë‚˜ê¸° ì „...<br>ë‹¹ì‹ ì˜ ì„±ë³„ì„ ì•Œë ¤ì£¼ì„¸ìš”.</div>
    </div>
</div>

<div class="volume-box">
    BGM ğŸ”Š <input type="range" min="0" max="100" value="20" oninput="changeVolume(this.value)">
</div>

<script>
    // --- ê²Œì„ ë°ì´í„° ---
    const ALL_QUESTIONS = [
        { q: "íœ´ì¼ì¸ë° ì•„ë¬´ë„ ë†€ì•„ ì£¼ì§€ ì•ŠëŠ”ë‹¤... ê·¸ëŸ¼ ë‹¹ì‹ ì€?", a: [{t: "ì—¬í–‰ì„ ë– ë‚œë‹¤", s: {Jolly: 4, Rash: 2}}, {t: "ë©í•˜ê²Œ ìˆëŠ”ë‹¤", s: {Relaxed: 4, Calm: 2}}, {t: "ë°©êµ¬ì„ì— ë°•í˜€ìˆëŠ”ë‹¤", s: {Lonely: 4, Quiet: 2}}] },
        { q: "ë¹„ë°€ì„ ë¬´ì‹¬ì½” ëˆ„ì„¤í•´ë²„ë¦° ì ì´ ìˆëŠ”ê°€?", a: [{t: "ìˆë‹¤", s: {Rash: 4, Lonely: 4}}, {t: "ì—†ë‹¤", s: {Hardy: 2}}] },
        { q: "ìš©ëˆ ê´€ë¦¬ëŠ” ì–´ë–»ê²Œ í•˜ëŠ”ê°€?", a: [{t: "ê¾¸ì¤€íˆ ëª¨ìœ¼ê³  ìˆë‹¤", s: {Hardy: 4}}, {t: "ê¸ˆë°© ì¨ë²„ë¦°ë‹¤", s: {Quirky: 4}}, {t: "ì ˆë°˜ì€ ì“°ê³  ëª¨ì€ë‹¤", s: {Calm: 2}}] },
        { q: "ëª¨ë¥´ëŠ” ê²ƒì€ ëª¨ë¥¸ë‹¤ê³  ì†”ì§í•˜ê²Œ ë§í•  ìˆ˜ ìˆëŠ”ê°€?", a: [{t: "ë§í•  ìˆ˜ ìˆë‹¤", s: {Docile: 4, Bold: 2}}, {t: "ì˜ ë§í•˜ì§€ ëª»í•œë‹¤", s: {Timid: 4}}] },
        { q: "ì¥ë˜ë¥¼ ì ì³ ë³´ë‹ˆ ê²°ê³¼ê°€ ë§¤ìš° ë‚˜ë¹´ë‹¤. ë„ˆë¼ë©´?", a: [{t: "ë§¤ìš° ë¶ˆì•ˆí•´ì§„ë‹¤", s: {Docile: 4}}, {t: "ìŠì–´ë²„ë¦°ë‹¤", s: {Jolly: 4, Relaxed: 2}}] },
        { q: "í’ì„ ì„ ì–¼ë§ˆë§Œí¼ ë¶ˆ ìˆ˜ ìˆëŠ”ê°€?", a: [{t: "í„°ì§€ê¸° ì§ì „ê¹Œì§€!", s: {Brave: 4, Impish: 4}}, {t: "ì ë‹¹íˆ ê·¸ë§Œë‘”ë‹¤", s: {Quiet: 2}}, {t: "ë¬´ì„œì›Œì„œ ëª» ë¶„ë‹¤", s: {Timid: 4}}] },
        { q: "ëª¨ë‘ì™€ ë‹¤ë¥¸ ì˜ê²¬ì´ë¼ë„ í™•ì‹¤íˆ ë§í•  ìˆ˜ ìˆëŠ”ê°€?", a: [{t: "ì˜ˆ", s: {Brave: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Lonely: 4, Timid: 2}}] },
        { q: "ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒì—ê²Œ ê³ ë°±í•˜ê³  ì‹¶ë‹¤! ë„ˆë¼ë©´?", a: [{t: "ë‹¹ë‹¹í•˜ê²Œ ì™¸ì¹œë‹¤!", s: {Brave: 4, Bold: 2}}, {t: "ì¥ë‚œì¹˜ë©° ê´€ì‹¬ì„ ëˆë‹¤", s: {Lonely: 4}}, {t: "ë¬´ì„œì›Œì„œ ëª» í•œë‹¤", s: {Timid: 2}}] },
        { q: "ê¸°ìœ ì¼ì´ ìˆìœ¼ë©´ ë¬´ì‹¬ì½” ì¶¤ì„ ì¶”ëŠ”ê°€?", a: [{t: "ì˜ˆ", s: {Jolly: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Calm: 2}}] },
        { q: "ìì£¼ ë‹¤ì¹˜ëŠ” íƒ€ì…ì¸ê°€?", a: [{t: "ì˜ˆ", s: {Impish: 4, Rash: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Calm: 2}}] }
    ];

    const POKEMON_DATA = {
        male: { Hardy: "ì•„ì°¨ëª¨", Docile: "íŒŒì´ë¦¬", Brave: "í”¼ì¹´ì¸„", Jolly: "ë¦¬ì•„ì½”", Impish: "íŒ½ë„ë¦¬", Naive: "ë¶ˆê½ƒìˆ­ì´", Bold: "ëª¨ë¶€ê¸°", Timid: "ë¸Œì¼€ì¸", Hasty: "ì—ë‚˜ë¹„", Sassy: "ëƒì˜¹", Quiet: "ë‚˜ë¬´ì§€ê¸°", Relaxed: "ë¨¹ê³ ì", Rash: "ë¬¼ì§±ì´", Quirky: "ê¼¬ë¶€ê¸°", Lonely: "ì´ìƒí•´ì”¨", Calm: "ì¹˜ì½”ë¦¬íƒ€" },
        female: { Hardy: "ë‚˜ë¬´ì§€ê¸°", Docile: "ì´ìƒí•´ì”¨", Brave: "íŒŒì´ë¦¬", Jolly: "ë¨¹ê³ ì", Impish: "ë¶ˆê½ƒìˆ­ì´", Naive: "ì—ë‚˜ë¹„", Bold: "ê¼¬ë¶€ê¸°", Timid: "ëª¨ë¶€ê¸°", Hasty: "í”¼ì¹´ì¸„", Sassy: "ë¦¬ì•„ì½”", Quiet: "ì¹˜ì½”ë¦¬íƒ€", Relaxed: "ì‹ìŠ¤í…Œì¼", Rash: "ì•„ì°¨ëª¨", Quirky: "íŒ½ë„ë¦¬", Lonely: "ë¬¼ì§±ì´", Calm: "ë¸Œì¼€ì¸" }
    };

    const KOREAN_TYPE_MAP = { Hardy: "ë…¸ë ¥í•˜ëŠ”", Docile: "ì˜¨ìˆœí•œ", Brave: "ìš©ê°í•œ", Jolly: "ëª…ë‘í•œ", Impish: "ì¥ë‚œê¾¸ëŸ¬ê¸°", Naive: "ì²œì§„ë‚œë§Œí•œ", Bold: "ëŒ€ë‹´í•œ", Timid: "ê²ìŸì´", Hasty: "ì„±ê¸‰í•œ", Sassy: "ê±´ë°©ì§„", Quiet: "ëƒ‰ì •í•œ", Relaxed: "ë¬´ì‚¬íƒœí‰", Rash: "ëœë ê±°ë¦¬ëŠ”", Quirky: "ë³€ë•ìŠ¤ëŸ¬ìš´", Lonely: "ì™¸ë¡œì›€íƒ€ëŠ”", Calm: "ì°¨ë¶„í•œ" };

    const POKEMON_ID_MAP = { "ì•„ì°¨ëª¨": 255, "íŒŒì´ë¦¬": 4, "í”¼ì¹´ì¸„": 25, "ë¦¬ì•„ì½”": 158, "íŒ½ë„ë¦¬": 393, "ë¶ˆê½ƒìˆ­ì´": 390, "ëª¨ë¶€ê¸°": 387, "ë¸Œì¼€ì¸": 155, "ì—ë‚˜ë¹„": 300, "ëƒì˜¹": 52, "ë‚˜ë¬´ì§€ê¸°": 252, "ë¨¹ê³ ì": 446, "ë¬¼ì§±ì´": 258, "ê¼¬ë¶€ê¸°": 7, "ì´ìƒí•´ì”¨": 1, "ì¹˜ì½”ë¦¬íƒ€": 152, "ì‹ìŠ¤í…Œì¼": 37 };

    // --- ë³€ìˆ˜ ê´€ë¦¬ ---
    let userGender = '';
    let currentIdx = 0;
    let scores = {};
    let testQuestions = [];

    // --- ì´ˆê¸° ì„¤ì • (ì„±ë³„ ì„ íƒ) ---
    function init() {
        const container = document.getElementById("answer-container");
        container.innerHTML = `
            <button class="answer-btn" onclick="startTest('male')">ë‚¨ì ì•„ì´</button>
            <button class="answer-btn" onclick="startTest('female')">ì—¬ì ì•„ì´</button>
        `;
    }

    function startTest(gender) {
        userGender = gender;
        testQuestions = [...ALL_QUESTIONS].sort(() => Math.random() - 0.5).slice(0, 8); // 8ë¬¸ì œë§Œ ì¶”ì¶œ
        Object.keys(KOREAN_TYPE_MAP).forEach(k => scores[k] = 0);
        if (player && player.playVideo) player.playVideo();
        nextQuestion();
    }

    function nextQuestion() {
        if (currentIdx >= testQuestions.length) {
            showResult();
            return;
        }

        const data = testQuestions[currentIdx];
        document.getElementById("main-text").innerText = data.q;
        document.getElementById("progress-fill").style.width = `${(currentIdx / testQuestions.length) * 100}%`;

        const container = document.getElementById("answer-container");
        container.innerHTML = "";
        data.a.forEach(ans => {
            const btn = document.createElement("button");
            btn.className = "answer-btn";
            btn.innerText = ans.t;
            btn.onclick = () => {
                for (let s in ans.s) scores[s] += ans.s[s];
                currentIdx++;
                nextQuestion();
            };
            container.appendChild(btn);
        });
    }

    function showResult() {
        document.getElementById("p-bar-wrap").classList.add("hidden");
        document.getElementById("answer-container").classList.add("hidden");
        
        const topType = Object.keys(scores).reduce((a, b) => scores[a] >= scores[b] ? a : b);
        const name = POKEMON_DATA[userGender][topType] || "í”¼ì¹´ì¸„";
        const typeStr = KOREAN_TYPE_MAP[topType];
        const pokeId = POKEMON_ID_MAP[name] || 25;

        const box = document.getElementById("question-box");
        box.style.height = "auto";
        box.innerHTML = `
            <div class="result-content">
                <p>ë‹¹ì‹ ì˜ ì˜¤ë¼ ìƒ‰ê¹”ë¡œ ë³´ì•„... ë‹¹ì‹ ì€ <br><strong>[${typeStr}]</strong> ì„±ê²©ì´êµ°ìš”!</p>
                <img id="pokemon-img" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokeId}.png">
                <p>ë‹¹ì‹ ì€ <strong>${name}</strong>ì…ë‹ˆë‹¤!</p>
                <button class="answer-btn" style="text-align:center; padding-left:0;" onclick="location.reload()">â–¶ ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        `;
    }

    // --- ìœ íŠœë¸Œ ë°°ê²½ìŒì•… (ê¸°ì¡´ ì½”ë“œ ìœ ì§€) ---
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);
    let player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '0', width: '0', videoId: 'ehI75lWfXhw',
            playerVars: { 'autoplay': 0, 'loop': 1, 'playlist': 'ehI75lWfXhw' }
        });
    }
    function changeVolume(val) { if(player) player.setVolume(val); }

    init();
</script>
</body>
</html>
