<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="ë‚˜ì™€ ë‹®ì€ í¬ì¼“ëª¬ì€ ëˆ„êµ¬ì¼ê¹Œ? í¬ì¼“ëª¬ ë¶ˆê°€ì‚¬ì˜ ë˜ì „ ì„±ê²© í…ŒìŠ¤íŠ¸">
    <title>í¬ì¼“ëª¬ ì„±ê²© í…ŒìŠ¤íŠ¸ | PMD Personality Test</title>
    <!-- í°íŠ¸ ìš°ì„  ìˆœìœ„ ë¡œë“œ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-neutral: #ffffff;
            --bg-dot: #e5e7eb;
            --window-bg: #1a202c;
            --border-green: #48bb78;
            --text-white: #f7fafc;
        }

        /* ê¸°ë³¸ ì´ˆê¸°í™” */
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        body {
            font-family: 'DungGeunMo', -apple-system, sans-serif;
            margin: 0; padding: 0;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
            background-color: var(--bg-neutral);
            background-image: radial-gradient(var(--bg-dot) 1px, transparent 1px);
            background-size: 20px 20px;
            color: #2d3748;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        #game-container {
            width: 90%;
            max-width: 450px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            opacity: 0; /* ë¡œë”© ì „ ê¹œë¹¡ì„ ë°©ì§€ */
            animation: fadeIn 0.5s forwards;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        .window {
            background: var(--window-bg);
            border: 4px solid var(--border-green);
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15), inset 0 0 0 2px #000;
            color: var(--text-white);
            padding: 20px;
        }

        /* ì§„í–‰ ë°” */
        .status-bar {
            display: flex; justify-content: space-between;
            font-size: 0.85rem; color: #718096; margin-bottom: 5px;
        }
        .progress-bar { height: 6px; background: #edf2f7; border-radius: 3px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--border-green); width: 0%; transition: width 0.3s ease; }

        /* ëŒ€í™”ì°½ ì˜ì—­ */
        #question-box {
            min-height: 130px; font-size: 1.15rem; line-height: 1.6;
            display: flex; align-items: center; justify-content: center;
            text-align: center; word-break: keep-all;
        }

        /* ë²„íŠ¼ ì˜ì—­ */
        #answer-box { display: flex; flex-direction: column; gap: 8px; }
        .btn {
            background: transparent; border: 1px solid transparent;
            color: var(--text-white); font-family: inherit;
            font-size: 1.05rem; text-align: left;
            padding: 12px 12px 12px 35px; cursor: pointer;
            position: relative; border-radius: 8px;
            transition: background 0.2s, border-color 0.2s;
        }
        .btn:active, .btn:hover { background: rgba(255, 255, 255, 0.1); border-color: var(--border-green); }
        .btn:active::before, .btn:hover::before { content: 'â–¶'; position: absolute; left: 12px; color: var(--border-green); }

        /* ì»¨íŠ¸ë¡¤ëŸ¬ */
        .controls {
            display: flex; justify-content: center; align-items: center;
            gap: 12px; margin-top: 10px; font-size: 0.85rem; color: #a0aec0;
        }
        input[type=range] { accent-color: var(--border-green); width: 100px; cursor: pointer; }

        /* ê²°ê³¼ì°½ ì¤‘ì•™ ì •ë ¬ í•µì‹¬ ë ˆì´ì•„ì›ƒ */
        .result-layout {
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; width: 100%; text-align: center;
        }
        #pokemon-img { width: 160px; height: 160px; margin: 15px 0; object-fit: contain; }
        .hidden { display: none !important; }

        /* ì‚¬ìš´ë“œ í”Œë ˆì´ì–´ ê°€ì‹œì„± ì œê±° */
        #player { position: fixed; bottom: 0; right: 0; width: 1px; height: 1px; opacity: 0; pointer-events: none; }
    </style>
</head>
<body>

<div id="player"></div>

<div id="game-container">
    <div id="ui-header">
        <div class="status-bar">
            <span id="step-name">ì„±ê²© ì§„ë‹¨</span>
            <span id="step-count">0 / 20</span>
        </div>
        <div class="progress-bar"><div id="progress-fill"></div></div>
    </div>

    <div id="question-box" class="window">
        <div id="text-display">íƒí—˜ì„ ì‹œì‘í•˜ê¸° ì „...<br>ë‹¹ì‹ ì˜ ì„±ë³„ì„ ì•Œë ¤ì£¼ì„¸ìš”.</div>
    </div>

    <div id="answer-box" class="window">
        <!-- JS ë Œë”ë§ -->
    </div>

    <div class="controls">
        <span>BGM ğŸ”ˆ</span>
        <input type="range" id="volume-slider" min="0" max="100" value="30">
        <span>ğŸ”Š</span>
    </div>
</div>

<script>
    // 1. ì§ˆë¬¸ ë°ì´í„° (ì´ 24ê°œ)
    const ALL_QUESTIONS = [
        { q: "íœ´ì¼ì¸ë° ì•„ë¬´ë„ ë†€ì•„ ì£¼ì§€ ì•ŠëŠ”ë‹¤... ê·¸ëŸ¼ ë‹¹ì‹ ì€?", a: [{t: "ì—¬í–‰ì„ ë– ë‚œë‹¤", s: {Jolly: 4}}, {t: "ë©í•˜ê²Œ ìˆëŠ”ë‹¤", s: {Relaxed: 4}}, {t: "ì§‘ì— ë°•í˜€ìˆëŠ”ë‹¤", s: {Lonely: 4}}] },
        { q: "ë¹„ë°€ì„ ë¬´ì‹¬ì½” ëˆ„ì„¤í•´ë²„ë¦° ì ì´ ìˆëŠ”ê°€?", a: [{t: "ìˆë‹¤", s: {Rash: 4}}, {t: "ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ëª¨ë¥´ëŠ” ê²ƒì€ ëª¨ë¥¸ë‹¤ê³  ì†”ì§í•˜ê²Œ ë§í•˜ë‚˜?", a: [{t: "ë§í•œë‹¤", s: {Docile: 4}}, {t: "ì˜ ë§í•˜ì§€ ëª»í•œë‹¤", s: {Timid: 4}}] },
        { q: "ë§¤ì¼ ìš´ë™í•˜ê¸°! ê³„ì†í•  ìˆ˜ ìˆì„ê¹Œ?", a: [{t: "ë‹¹ì—°í•˜ì§€", s: {Hardy: 4}}, {t: "ì‘ì‹¬ì‚¼ì¼ì´ë‹¤", s: {Quirky: 4}}] },
        { q: "ê¸°ìœ ì¼ì´ ìˆìœ¼ë©´ ë‚˜ë„ ëª¨ë¥´ê²Œ ì¶¤ì´ ë‚˜ì˜¤ë‚˜?", a: [{t: "ì˜ˆ", s: {Jolly: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Quiet: 4}}] },
        { q: "ìì£¼ ë„˜ì–´ì§€ê±°ë‚˜ ë‹¤ì¹˜ëŠ” í¸ì¸ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Rash: 4}}, {t: "ì „í˜€", s: {Calm: 4}}] },
        { q: "TV ì±„ë„ì„ ì•„ì£¼ ìì£¼ ë°”ê¾¸ëŠ” í¸ì¸ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Hasty: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Calm: 4}}] },
        { q: "ë„ì‹œì™€ ì‹œê³¨ ì¤‘ ì–´ëŠ ìª½ì´ ì·¨í–¥ì¸ê°€?", a: [{t: "í™”ë ¤í•œ ë„ì‹œ", s: {Sassy: 4}}, {t: "ì¡°ìš©í•œ ì‹œê³¨", s: {Calm: 4}}] },
        { q: "ì£¼ëª©ë°›ëŠ” ìë¦¬ì— ì„œëŠ” ê²ƒì„ ì¦ê¸°ë‚˜?", a: [{t: "ì¦ê¸´ë‹¤", s: {Sassy: 4}}, {t: "í”¼í•˜ê³  ì‹¶ë‹¤", s: {Lonely: 4}}] },
        { q: "ê³„íšì„ ì„¸ìš°ê³  ê·¸ëŒ€ë¡œ ì‹¤ì²œí•˜ëŠ” í¸ì¸ê°€?", a: [{t: "ì˜ˆ", s: {Hardy: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Quirky: 4}}] },
        { q: "ê±°ì§“ë§ë„ ì„ ì˜ë¼ë©´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ë‚˜?", a: [{t: "ì˜ˆ", s: {Quiet: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Brave: 4}}] },
        { q: "ì§€í•˜ì‹¤ì—ì„œ ìˆ˜ìƒí•œ ì†Œë¦¬ê°€ ë“¤ë¦¬ë©´?", a: [{t: "ê°€ë³¸ë‹¤", s: {Brave: 4}}, {t: "ë„ë§ì¹œë‹¤", s: {Timid: 4}}] },
        { q: "ì•½ì† ì‹œê°„ì— ëŠ¦ëŠ” ê²½ìš°ê°€ ì¦ì€ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Rash: 4}}, {t: "ì ˆëŒ€ ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ì¹œêµ¬ê°€ ë§›ìˆëŠ” ê²ƒì„ í˜¼ì ë‹¤ ë¨¹ì–´ë²„ë ¸ë‹¤!", a: [{t: "í™”ë‚¸ë‹¤", s: {Jolly: 4}}, {t: "ìƒê´€ì—†ë‹¤", s: {Calm: 4}}] },
        { q: "ë‚˜ëŠ” ë‚¨ë“¤ë³´ë‹¤ íŠ¹ë³„í•œ ì²œì¬ë¼ê³  ìƒê°í•œ ì  ìˆë‚˜?", a: [{t: "ìˆë‹¤", s: {Sassy: 4}}, {t: "ì „í˜€", s: {Hardy: 4}}] },
        { q: "ì£¼ìœ„ê°€ ì†Œë€ìŠ¤ëŸ¬ì›Œë„ ì§‘ì¤‘ì„ ì˜ í•˜ë‚˜?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Relaxed: 4}}, {t: "ì•„ë‹ˆì˜¤", s: {Lonely: 4}}] },
        { q: "ìœ ë ¹ì„  ì•ˆì— ë¬´ì—‡ì´ ìˆì„ ê²ƒ ê°™ë‚˜?", a: [{t: "ë³´ë¬¼!", s: {Jolly: 4}}, {t: "ë¬´ì„œìš´ ê·€ì‹ ", s: {Timid: 4}}] },
        { q: "ì…”ì¸ ë¥¼ ë’¤ì§‘ì–´ ì…ê³  ë‚˜ì™”ë‹¤ëŠ” ë§ì„ ë“¤ìœ¼ë©´?", a: [{t: "ë‹¹í™©í•œë‹¤", s: {Docile: 4}}, {t: "ì›ƒì–´ë„˜ê¸´ë‹¤", s: {Rash: 4}}] },
        { q: "ì‚¬ë†“ê³  ì“°ì§€ ì•ŠëŠ” ë¬¼ê±´ì´ ë§ì€ê°€?", a: [{t: "ë§ë‹¤", s: {Quirky: 4}}, {t: "ì—†ë‹¤", s: {Hardy: 4}}] },
        { q: "ê°€ê²Œ ì ì›ì´ ë§ì„ ê±¸ì–´ì˜¤ë©´?", a: [{t: "ëŒ€ë‹µí•œë‹¤", s: {Jolly: 4}}, {t: "ë¶€ë‹´ìŠ¤ëŸ½ë‹¤", s: {Timid: 4}}] },
        { q: "ì •ì˜ë¥¼ ìœ„í•´ì„œë¼ë©´ ì‹¸ìš¸ ìš©ê¸°ê°€ ìˆë‚˜?", a: [{t: "ìˆë‹¤", s: {Brave: 4}}, {t: "ëª¨ë¥´ê² ë‹¤", s: {Quiet: 4}}] },
        { q: "ì²˜ìŒ ë³¸ ì‚¬ëŒê³¼ ê¸ˆë°© ì¹œí•´ì§€ëŠ”ê°€?", a: [{t: "ê·¸ë ‡ë‹¤", s: {Jolly: 4}}, {t: "ì‹œê°„ì´ ê±¸ë¦°ë‹¤", s: {Lonely: 4}}] },
        { q: "ë³µê¶Œì„ ì‚¬ë©´ ë‹¹ì²¨ë  ê²ƒ ê°™ì€ ê¸°ë¶„ì´ ë“œë‚˜?", a: [{t: "í•­ìƒ ê·¸ë ‡ë‹¤", s: {Naive: 4}}, {t: "ê¸°ëŒ€ ì•ˆ í•œë‹¤", s: {Quiet: 4}}] },
        { q: "ê¹œê¹œí•œ ë°©ì—ì„œ í˜¼ì ì˜ ìˆ˜ ìˆë‚˜?", a: [{t: "ì „í˜€ ë¬´ì„­ì§€ ì•Šë‹¤", s: {Brave: 4}}, {t: "ë¬´ì„­ë‹¤", s: {Timid: 4}}] }
    ];

    // 2. ì„±ê²© & í¬ì¼“ëª¬ ë§¤í•‘
    const KOREAN_TYPE_MAP = {
        Hardy: "ë…¸ë ¥í•˜ëŠ”", Docile: "ì˜¨ìˆœí•œ", Brave: "ìš©ê°í•œ", Jolly: "ëª…ë‘í•œ", Impish: "ì¥ë‚œê¾¸ëŸ¬ê¸°", 
        Naive: "ì²œì§„ë‚œë§Œí•œ", Bold: "ëŒ€ë‹´í•œ", Timid: "ê²ìŸì´", Hasty: "ì„±ê¸‰í•œ", Sassy: "ê±´ë°©ì§„", 
        Quiet: "ëƒ‰ì •í•œ", Relaxed: "ë¬´ì‚¬íƒœí‰", Rash: "ëœë ê±°ë¦¬ëŠ”", Quirky: "ë³€ë•ìŠ¤ëŸ¬ìš´", 
        Lonely: "ì™¸ë¡œì›€íƒ€ëŠ”", Calm: "ì°¨ë¶„í•œ"
    };

    const POKEMON_MAP = {
        male: { Hardy: "ì•„ì°¨ëª¨", Docile: "íŒŒì´ë¦¬", Brave: "í”¼ì¹´ì¸„", Jolly: "ë¦¬ì•„ì½”", Impish: "íŒ½ë„ë¦¬", Naive: "ë¶ˆê½ƒìˆ­ì´", Bold: "ëª¨ë¶€ê¸°", Timid: "ë¸Œì¼€ì¸", Hasty: "ì—ë‚˜ë¹„", Sassy: "ëƒì˜¹", Quiet: "ë‚˜ë¬´ì§€ê¸°", Relaxed: "ë¨¹ê³ ì", Rash: "ë¬¼ì§±ì´", Quirky: "ê¼¬ë¶€ê¸°", Lonely: "ì´ìƒí•´ì”¨", Calm: "ì¹˜ì½”ë¦¬íƒ€" },
        female: { Hardy: "ë‚˜ë¬´ì§€ê¸°", Docile: "ì´ìƒí•´ì”¨", Brave: "íŒŒì´ë¦¬", Jolly: "ë¨¹ê³ ì", Impish: "ë¶ˆê½ƒìˆ­ì´", Naive: "ì—ë‚˜ë¹„", Bold: "ê¼¬ë¶€ê¸°", Timid: "ëª¨ë¶€ê¸°", Hasty: "í”¼ì¹´ì¸„", Sassy: "ë¦¬ì•„ì½”", Quiet: "ì¹˜ì½”ë¦¬íƒ€", Relaxed: "ì‹ìŠ¤í…Œì¼", Rash: "ì•„ì°¨ëª¨", Quirky: "íŒ½ë„ë¦¬", Lonely: "ë¬¼ì§±ì´", Calm: "ë¸Œì¼€ì¸" }
    };

    const ID_MAP = { "ì•„ì°¨ëª¨": 255, "íŒŒì´ë¦¬": 4, "í”¼ì¹´ì¸„": 25, "ë¦¬ì•„ì½”": 158, "íŒ½ë„ë¦¬": 393, "ë¶ˆê½ƒìˆ­ì´": 390, "ëª¨ë¶€ê¸°": 387, "ë¸Œì¼€ì¸": 155, "ì—ë‚˜ë¹„": 300, "ëƒì˜¹": 52, "ë‚˜ë¬´ì§€ê¸°": 252, "ë¨¹ê³ ì": 446, "ë¬¼ì§±ì´": 258, "ê¼¬ë¶€ê¸°": 7, "ì´ìƒí•´ì”¨": 1, "ì¹˜ì½”ë¦¬íƒ€": 152, "ì‹ìŠ¤í…Œì¼": 37 };

    // 3. ìƒíƒœ ê´€ë¦¬
    let userGender = '';
    let currentIdx = 0;
    let scores = {};
    let testPool = [];
    const MAX_QUESTIONS = 20;

    // 4. ìœ íŠœë¸Œ í”Œë ˆì´ì–´ ì œì–´ (ì‚¬íŒŒë¦¬ ëŒ€ì‘ ìµœì í™”)
    let player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            videoId: 'ehI75lWfXhw',
            playerVars: { 'autoplay': 0, 'loop': 1, 'playlist': 'ehI75lWfXhw', 'controls': 0, 'playsinline': 1 },
            events: { 'onReady': onPlayerReady }
        });
    }

    function onPlayerReady(event) {
        const slider = document.getElementById('volume-slider');
        player.setVolume(slider.value);
        slider.oninput = (e) => player.setVolume(e.target.value);
    }

    // 5. ê²Œì„ ë¡œì§
    function init() {
        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = `
            <button class="btn" onclick="startTest('male')">ë‚¨ì ì•„ì´</button>
            <button class="btn" onclick="startTest('female')">ì—¬ì ì•„ì´</button>
        `;
    }

    function startTest(gender) {
        // ìœ ì € í´ë¦­ ì‹œ ì‚¬íŒŒë¦¬ ì˜¤ë””ì˜¤ ë½ í•´ì œ
        if(player && player.playVideo) {
            player.playVideo();
            player.unMute();
        }
        userGender = gender;
        Object.keys(KOREAN_TYPE_MAP).forEach(k => scores[k] = 0);
        testPool = [...ALL_QUESTIONS].sort(() => Math.random() - 0.5).slice(0, MAX_QUESTIONS);
        render();
    }

    function render() {
        if (currentIdx >= testPool.length) {
            showResult();
            return;
        }
        
        const data = testPool[currentIdx];
        document.getElementById("text-display").innerText = data.q;
        document.getElementById("step-count").innerText = `${currentIdx + 1} / ${MAX_QUESTIONS}`;
        document.getElementById("progress-fill").style.width = `${((currentIdx + 1) / MAX_QUESTIONS) * 100}%`;

        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = "";
        data.a.forEach(ans => {
            const btn = document.createElement("button");
            btn.className = "btn";
            btn.innerText = ans.t;
            btn.onclick = () => {
                for (let s in ans.s) scores[s] = (scores[s] || 0) + ans.s[s];
                currentIdx++;
                render();
            };
            ansBox.appendChild(btn);
        });
    }

    function showResult() {
        document.getElementById("answer-box").classList.add("hidden");
        document.getElementById("step-name").innerText = "ë¶„ì„ ì™„ë£Œ";
        
        const maxScore = Math.max(...Object.values(scores));
        const winners = Object.keys(scores).filter(k => scores[k] === maxScore);
        const topKey = winners[Math.floor(Math.random() * winners.length)];
        
        const typeKR = KOREAN_TYPE_MAP[topKey];
        const name = POKEMON_MAP[userGender][topKey] || "í”¼ì¹´ì¸„";
        const pokeId = ID_MAP[name] || 25;

        const qBox = document.getElementById("question-box");
        // onerror í•¸ë“¤ëŸ¬ë¡œ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ì²˜ë¦¬
        qBox.innerHTML = `
            <div class="result-layout">
                <p>ë‹¹ì‹ ì˜ ì˜¤ë¼ ìƒ‰ê¹”ë¡œ ë³´ì•„... <br><strong>[${typeKR}]</strong> ì„±ê²©ì´êµ°ìš”!</p>
                <img id="pokemon-img" 
                     src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokeId}.png"
                     onerror="this.src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/25.png'; this.onerror=null;">
                <p style="font-size:1.4rem; color:var(--border-green);">ë‹¹ì‹ ì€ <strong>${name}</strong>ì…ë‹ˆë‹¤!</p>
                <button class="btn" style="text-align:center; padding-left:15px; margin-top:10px;" onclick="location.reload()">â–¶ ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        `;
    }

    // ì™¸ë¶€ API ë¡œë“œ
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    const firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    init();
</script>
</body>
</html>
