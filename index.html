<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>포켓몬 성격 테스트 - 편안한 버전</title>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        :root {
            /* 눈이 편한 색상 조합 */
            --window-bg: rgba(12, 26, 43, 0.95); /* 깊은 남색 (약간 투명) */
            --border-green: #4ade80;            /* 차분한 에메랄드 그린 */
            --text-white: #f8f9fa;               /* 미색 (순백색보다 눈이 편함) */
            --bg-soft-pink: #fdf2f8;            /* 매우 연한 분홍색 */
            --bg-wave-pink: #fbcfe8;            /* 부드러운 분홍색 */
        }

        body {
            font-family: 'DungGeunMo', monospace;
            margin: 0; padding: 0;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
            /* 배경: 움직임을 아주 느리게 하고 대비를 낮춤 */
            background: linear-gradient(135deg, var(--bg-soft-pink) 25%, transparent 25%) -50px 0,
                        linear-gradient(225deg, var(--bg-soft-pink) 25%, transparent 25%) -50px 0,
                        linear-gradient(315deg, var(--bg-soft-pink) 25%, transparent 25%),
                        linear-gradient(45deg, var(--bg-soft-pink) 25%, transparent 25%);
            background-size: 100px 100px;
            background-color: var(--bg-wave-pink);
            animation: slowMove 60s linear infinite; /* 매우 느린 움직임 */
        }

        @keyframes slowMove {
            from { background-position: 0 0; }
            to { background-position: 500px 500px; }
        }

        #game-container {
            width: 90%;
            max-width: 550px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            position: relative;
            z-index: 10;
        }

        /* 공통 윈도우 스타일 */
        .window {
            background: var(--window-bg);
            border: 4px solid var(--border-green);
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3), inset 0 0 0 2px #000;
            color: var(--text-white);
            padding: 20px;
            box-sizing: border-box;
        }

        /* 질문 영역 */
        #question-box {
            min-height: 100px;
            font-size: 1.25rem;
            line-height: 1.6;
            word-break: keep-all;
            display: flex;
            align-items: center;
        }

        /* 선택지 영역 */
        #answer-box {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* 버튼 스타일 */
        .btn {
            background: transparent;
            border: 2px solid transparent;
            color: var(--text-white);
            font-family: 'DungGeunMo', monospace;
            font-size: 1.1rem;
            text-align: left;
            padding: 12px 15px 12px 35px;
            cursor: pointer;
            border-radius: 8px;
            position: relative;
            transition: all 0.2s;
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--border-green);
        }

        .btn:hover::before {
            content: '▶';
            position: absolute;
            left: 12px;
            color: var(--border-green);
        }

        /* 진행도 표시 */
        .progress-text {
            color: var(--window-bg);
            font-size: 0.9rem;
            margin-bottom: 5px;
            text-align: right;
            font-weight: bold;
        }

        .progress-bar {
            height: 8px;
            background: rgba(0,0,0,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        #progress-fill {
            height: 100%;
            background: var(--border-green);
            width: 0%;
            transition: width 0.4s ease;
        }

        /* 결과 화면 */
        .result-layout {
            text-align: center;
            animation: fadeIn 0.8s ease;
        }
        #pokemon-img {
            width: 150px;
            height: 150px;
            margin: 15px 0;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="player" style="position: absolute; left: -9999px;"></div>

<div id="game-container">
    <div id="ui-header">
        <div class="progress-text" id="status-text">준비 중...</div>
        <div class="progress-bar"><div id="progress-fill"></div></div>
    </div>

    <!-- 메인 질문창 -->
    <div id="question-box" class="window">
        <div id="text-display">탐험을 떠나기 전... 당신의 성별은 무엇인가요?</div>
    </div>

    <!-- 선택지창 -->
    <div id="answer-box" class="window">
        <!-- 버튼 동적 생성 -->
    </div>
</div>

<script>
    // 질문 데이터
    const QUESTIONS = [
        { q: "휴일인데 아무도 놀아 주지 않는다... 그럼 당신은?", a: [{t: "여행을 떠난다", s: {Jolly: 4}}, {t: "멍하게 있는다", s: {Relaxed: 4}}, {t: "방구석에 박혀있는다", s: {Lonely: 4}}] },
        { q: "비밀을 무심코 누설해버린 적이 있는가?", a: [{t: "있다", s: {Rash: 4}}, {t: "없다", s: {Hardy: 4}}] },
        { q: "모르는 것은 모른다고 솔직하게 말할 수 있는가?", a: [{t: "말할 수 있다", s: {Docile: 4}}, {t: "잘 말하지 못한다", s: {Timid: 4}}] },
        { q: "매일 복근 운동 10회. 계속할 수 있을까?", a: [{t: "당연하다", s: {Hardy: 4}}, {t: "하다 말 것이다", s: {Quirky: 4}}] },
        { q: "기쁜 일이 있으면 무심코 춤을 추는가?", a: [{t: "예", s: {Jolly: 4}}, {t: "아니오", s: {Quiet: 4}}] }
    ];

    const POKEMON_MAP = {
        male: { Hardy: "아차모", Docile: "파이리", Jolly: "리아코", Relaxed: "먹고자", Rash: "물짱이", Lonely: "이상해씨", Timid: "브케인", Quirky: "꼬부기", Quiet: "나무지기" },
        female: { Hardy: "나무지기", Docile: "이상해씨", Jolly: "먹고자", Relaxed: "식스테일", Rash: "아차모", Lonely: "물짱이", Timid: "모부기", Quirky: "팽도리", Quiet: "치코리타" }
    };

    const ID_MAP = { "아차모": 255, "파이리": 4, "리아코": 158, "먹고자": 446, "물짱이": 258, "이상해씨": 1, "브케인": 155, "나무지기": 252, "식스테일": 37, "모부기": 387, "꼬부기": 7, "팽도리": 393, "치코리타": 152 };

    let userGender = '';
    let currentIdx = 0;
    let scores = {};

    function init() {
        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = `
            <button class="btn" onclick="startTest('male')">남자 아이</button>
            <button class="btn" onclick="startTest('female')">여자 아이</button>
        `;
        document.getElementById("status-text").innerText = "STEP 0 / " + QUESTIONS.length;
    }

    function startTest(gender) {
        userGender = gender;
        ["Hardy","Docile","Jolly","Relaxed","Rash","Lonely","Timid","Quirky","Quiet"].forEach(t => scores[t] = 0);
        if(player && player.playVideo) player.playVideo();
        render();
    }

    function render() {
        if (currentIdx >= QUESTIONS.length) {
            showResult();
            return;
        }
        
        const data = QUESTIONS[currentIdx];
        document.getElementById("text-display").innerText = data.q;
        document.getElementById("status-text").innerText = `질문 ${currentIdx + 1} / ${QUESTIONS.length}`;
        document.getElementById("progress-fill").style.width = `${((currentIdx + 1) / QUESTIONS.length) * 100}%`;

        const ansBox = document.getElementById("answer-box");
        ansBox.innerHTML = "";
        data.a.forEach(ans => {
            const btn = document.createElement("button");
            btn.className = "btn";
            btn.innerText = ans.t;
            btn.onclick = () => {
                for (let s in ans.s) scores[s] = (scores[s] || 0) + ans.s[s];
                currentIdx++;
                render();
            };
            ansBox.appendChild(btn);
        });
    }

    function showResult() {
        document.getElementById("answer-box").classList.add("hidden");
        document.getElementById("status-text").innerText = "결과 분석 완료";
        
        const maxScore = Math.max(...Object.values(scores));
        const winners = Object.keys(scores).filter(k => scores[k] === maxScore);
        const topType = winners[Math.floor(Math.random() * winners.length)];
        
        const name = POKEMON_MAP[userGender][topType] || "피카츄";
        const pokeId = ID_MAP[name] || 25;

        const qBox = document.getElementById("question-box");
        qBox.innerHTML = `
            <div class="result-layout">
                <p style="font-size:1rem; margin-bottom:5px;">당신은 <strong>[${topType}]</strong> 성격이군요!</p>
                <img id="pokemon-img" src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${pokeId}.png">
                <p style="font-size:1.5rem; color:var(--border-green);">당신은 <strong>${name}</strong>입니다!</p>
                <button class="btn" style="display:inline-block; margin-top:10px;" onclick="location.reload()">▶ 다시 테스트하기</button>
            </div>
        `;
    }

    // 유튜브 API (음악)
    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '0', width: '0', videoId: 'ehI75lWfXhw',
            playerVars: { 'autoplay': 0, 'loop': 1, 'playlist': 'ehI75lWfXhw' }
        });
    }
    const script = document.createElement('script');
    script.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(script);

    init();
</script>
</body>
</html>
